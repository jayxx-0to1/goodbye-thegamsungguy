<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>goodbye donghwan</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- í°íŠ¸ -->
<style>
@import url('https://cdn.jsdelivr.net/npm/galmuri@latest/dist/galmuri.css');

@font-face {
    font-family: 'Galmuri11';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2506-1@1.0/Galmuri11-Bold.woff2') format('woff2');
    font-weight: 700;
    font-display: swap;
}

/* ëª¨ë“  ìš”ì†Œ ë°•ìŠ¤ ì‚¬ì´ì¦ˆ í†µì¼ */
* {
    box-sizing: border-box;
}

body {
    font-family: 'Galmuri11', sans-serif;
    background: linear-gradient(to bottom, #ffffff 0%, #ffe6ee 100%);
    margin: 0;
    padding: 0;
    color: #7a5f66;
    text-align: center;
    font-size: 10px;
}

/* ì½˜í…ì¸  í­ í†µì¼ */
.content-wrapper {
    width: 90%;
    max-width: 780px;
    margin: 0 auto;
}

/* ìƒë‹¨ ì¹´í”¼ë¼ì´íŠ¸ */
.copyright {
    width: 100%;
    text-align: center;
    font-size: 9px;
    color: #9d7a83;
    margin-top: 35px;
    margin-bottom: 5px;
    opacity: 0.8;
}

/* ìƒë‹¨ ìŒì•… ì˜ì—­ */
header {
    width: 100%;
    position: relative;
    padding: 25px 0 15px 0;
}

.top-right-box {
    position: absolute;
    top: 15px;
    right: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.music-text {
    font-size: 12px;
    color: #8f6b74;
    opacity: 0.9;
    white-space: nowrap;
    position: relative;
    top: 2px;
}

/* â–¶ / â¸ ë²„íŠ¼ */
.music-toggle {
    background: #fce1ea;
    border: 1px solid #e8b9c5;
    padding: 4px 8px;
    font-size: 12px;
    border-radius: 6px;
    cursor: pointer;
    color: #8a6d74;
    font-weight: bold;
}

.music-toggle:hover {
    background: #f8cddd;
}

/* ìœ íŠœë¸Œ í”Œë ˆì´ì–´ ìˆ¨ê¸°ê¸° */
#player {
    width: 1px;
    height: 1px;
    opacity: 0;
    pointer-events: none;
}

/* ëŒ€í‘œ ì´ë¯¸ì§€ */
.hero-image {
    width: 100%;
    max-width: 780px;
    border-radius: 0;
    background-image: url('https://github.com/jayxx-0to1/goodbye-thegamsungguy/blob/main/hdh-mainimg.gif?raw=true');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    position: relative;
    padding-bottom: 56.25%;
    margin: 25px auto 0 auto;
    box-shadow: 0 4px 14px rgba(255, 165, 185, 0.25);
}

/* ê³µí†µ ì¹´ë“œ */
.section {
    margin: 25px auto;
    width: 100%;
    max-width: 780px;
    background: #ffffff;
    padding: 22px 25px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(255, 150, 170, 0.15);
}

/* ì…ë ¥ ì˜ì—­ */
.input-wrapper {
    width: 80%;
    margin: 0 auto;
}

input, textarea {
    font-family: 'Galmuri11', sans-serif;
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    border-radius: 7px;
    border: 1px solid #e9c8d2;
    background: #fff7fa;
    font-size: 10px;
}

textarea {
    height: 70px;
    resize: vertical;
}

.sub-explain {
    font-size: 9px;
    color: #8a6d74;
    margin-bottom: 10px;
    opacity: 0.9;
}

/* ë©”ì‹œì§€ ë°•ìŠ¤ */
.msg-item {
    padding: 10px 0;
    border-bottom: 1px solid #f1cfd8;
    text-align: left;
    font-size: 11.5px;
    position: relative;
}

.msg-nick {
    font-weight: bold;
    margin-bottom: 3px;
    color: #6f4c54;
}

/* ì‚­ì œ ë²„íŠ¼ */
.delete-btn {
    background: #ffffff;
    border: 1px solid #e3c3cb;
    color: #8a6d74;
    padding: 2px 6px;
    font-size: 9px;
    border-radius: 4px;
    cursor: pointer;
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
}

.delete-btn:hover {
    background: #fbe6ee;
}

/* ê´€ë¦¬ì ëª¨ë“œ ë²„íŠ¼ */
.admin-btn {
    margin: 25px auto;
    font-size: 9px;
    color: #8a6d74;
    text-decoration: underline;
    cursor: pointer;
    opacity: 0.85;
}

.admin-btn:hover {
    opacity: 1;
}
</style>
</head>

<body>

<div class="copyright">
    Copyright. 2025. Team Whale All rights reserved.
</div>

<!-- ìƒë‹¨ ìŒì•… ì˜ì—­ -->
<header>
    <div class="top-right-box">
        <div class="music-text">ğŸµToday's BGM - ë¹„í–‰ìš´(Healing ver.)</div>

        <!-- ìŒì•… ì¬ìƒ/ì¼ì‹œì •ì§€ ë²„íŠ¼ -->
        <button id="musicToggleBtn" class="music-toggle">â¸</button>
    </div>

    <!-- YouTube API Player -->
    <div id="player"></div>
</header>

<!-- ì½˜í…ì¸  ê³µí†µ ë˜í¼ -->
<div class="content-wrapper">

    <!-- ëŒ€í‘œ ì´ë¯¸ì§€ -->
    <div class="hero-image"></div>

    <!-- ë°©ëª…ë¡ ì‘ì„± -->
    <div class="section">
        <h2 style="margin-top:0;">ì¼ì´Œí‰ ì‘ì„±í•˜ê¸°</h2>
        <div class="sub-explain">ë™í™˜êµ°ì˜ ë§ˆì§€ë§‰ì´ í–‰ë³µí•  ìˆ˜ ìˆë„ë¡, ì—¬ëŸ¬ë¶„ì˜ ì¶”ì–µì„ ë‹´ì•„ ì¼ì´Œí‰ì„ ì‘ì„±í•´ì£¼ì„¸ìš” ğŸ™ğŸ»</div>

        <div class="input-wrapper">
            <input id="nickname" placeholder="ë‹‰ë„¤ì„">
            <textarea id="comment" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            <button onclick="saveMessage()">ì „ë‹¬í•˜ê¸°</button>
        </div>
    </div>

    <!-- ë©”ì‹œì§€ ëª©ë¡ -->
    <div class="section">
        <h2 style="margin-top:0;">[ì¼ì´Œí‰] ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤ ğŸ’Œ</h2>
        <div id="messageList"></div>
    </div>

    <!-- ê´€ë¦¬ì ëª¨ë“œ ë²„íŠ¼ -->
    <div class="admin-btn" onclick="adminLogin()">ê´€ë¦¬ì ëª¨ë“œ</div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
// Firebase ì„¤ì •
const firebaseConfig = {
  apiKey: "AIzaSyAjMGp5dOAZ5ms8MGYD9C2XziV8YsoWjvU",
  authDomain: "goodbye-dongwhan.firebaseapp.com",
  databaseURL: "https://goodbye-dongwhan-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "goodbye-dongwhan",
  storageBucket: "goodbye-dongwhan.firebasestorage.app",
  messagingSenderId: "322370249896",
  appId: "1:322370249896:web:a5da7e2095208f058f4e9d"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ìœ ì € UID
if (!localStorage.getItem("guest_uid")) {
    localStorage.setItem("guest_uid", "uid_" + Date.now() + "_" + Math.random().toString(36).substring(2, 9));
}
const myUID = localStorage.getItem("guest_uid");

// ê´€ë¦¬ì ëª¨ë“œ
let isAdmin = localStorage.getItem("isAdmin") === "true";

function adminLogin() {
    const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
    if (pw === "whaleproject") {
        alert("ê´€ë¦¬ì ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
        isAdmin = true;
        localStorage.setItem("isAdmin", "true");
        renderMessages();
    } else {
        alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
    }
}

// ë©”ì‹œì§€ ì €ì¥
function saveMessage() {
    const nick = document.getElementById("nickname").value.trim();
    const msg = document.getElementById("comment").value.trim();

    if (!nick || !msg) {
        alert("ë‹‰ë„¤ì„ê³¼ ë©”ì‹œì§€ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        return;
    }

    db.ref("messages").push({
        nickname: nick,
        message: msg,
        uid: myUID,
        time: Date.now()
    });

    document.getElementById("nickname").value = "";
    document.getElementById("comment").value = "";
}

// ë©”ì‹œì§€ ì‚­ì œ
function deleteMessage(key) {
    if (!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
    db.ref("messages/" + key).remove();
}

// ë©”ì‹œì§€ ë Œë”ë§
function renderMessages() {
    db.ref("messages").once("value", (snapshot) => {
        const list = document.getElementById("messageList");
        list.innerHTML = "";

        snapshot.forEach(child => {
            const v = child.val();
            const isMine = (v.uid === myUID);
            const deletable = isMine || isAdmin;

            list.innerHTML += `
                <div class="msg-item">
                    <div class="msg-nick">${v.nickname}</div>
                    <div>${v.message}</div>
                    ${deletable ? `<button class="delete-btn" onclick="deleteMessage('${child.key}')">ì‚­ì œ</button>` : ""}
                </div>
            `;
        });
    });
}

db.ref("messages").on("value", () => renderMessages());

//
// ğŸ§ YouTube Music Control (Iframe API)
//

// 1) YouTube API ë¡œë“œ
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
document.body.appendChild(tag);

let player;

// 2) API Ready â†’ Player ìƒì„±
function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
        height: '1',
        width: '1',
        videoId: 'tarCvk403H4',  // ì˜ìƒ ID
        playerVars: {
            autoplay: 1,
            loop: 1,
            playlist: 'tarCvk403H4',
            controls: 0,
            modestbranding: 1,
            showinfo: 0
        }
    });
}

// 3) ë²„íŠ¼ í† ê¸€
const toggleBtn = document.getElementById("musicToggleBtn");
let isPlaying = true;

toggleBtn.addEventListener("click", function () {
    if (isPlaying) {
        player.pauseVideo();
        toggleBtn.textContent = "â–¶";  // ì¬ìƒ
    } else {
        player.playVideo();
        toggleBtn.textContent = "â¸";  // ì¼ì‹œì •ì§€
    }
    isPlaying = !isPlaying;
});
</script>

</body>
</html>
