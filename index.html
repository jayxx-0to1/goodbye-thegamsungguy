<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>goodbye donghwan</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- í°íŠ¸ -->
<style>
@import url('https://cdn.jsdelivr.net/npm/galmuri@latest/dist/galmuri.css');

@font-face {
    font-family: 'Galmuri11';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2506-1@1.0/Galmuri11-Bold.woff2') format('woff2');
    font-weight: 700;
    font-display: swap;
}

/* ëª¨ë“  ìš”ì†Œ ë°•ìŠ¤ ì‚¬ì´ì¦ˆ í†µì¼ */
* {
    box-sizing: border-box;
}

body {
    font-family: 'Galmuri11', sans-serif;
    background: #f8f3eb;
    margin: 0;
    padding: 0;
    color: #3e3e3e;
    text-align: center;
    font-size: 10px;
}

/* ì½˜í…ì¸  í­ í†µì¼ */
.content-wrapper {
    width: 90%;
    max-width: 780px;
    margin: 0 auto;
}

/* ìƒë‹¨ ì¹´í”¼ë¼ì´íŠ¸ */
copyright {
    width: 100%;
    text-align: center;
    font-size: 9px;
    color: #8a8177;
    margin-top: 25px;
    margin-bottom: 5px;
    opacity: 0.7;
}

/* ìƒë‹¨ ìŒì•… ì˜ì—­ */
header {
    width: 100%;
    position: relative;
    padding: 25px 0 15px 0;
}

.music-box {
    width: 55px;
    height: 38px;
    opacity: 0.9;
    border-radius: 6px;
}

.top-right-box {
    position: absolute;
    top: 15px;
    right: 20px;
    display: flex;
    align-items: center; 
    gap: 8px;
}

.music-text {
    font-size: 12px;
    color: #5a4a3b;
    opacity: 0.9;
    white-space: nowrap;
    position: relative;
    top: 2px;
}

/* ëŒ€í‘œ ì´ë¯¸ì§€ */
.hero-image {
    width: 100%;
    max-width: 780px;
    border-radius: 0;
    background-image: url('https://github.com/jayxx-0to1/goodbye-thegamsungguy/blob/main/hdhmain-testimage.png?raw=true');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    position: relative;
    padding-bottom: 56.25%;
    margin: 25px auto 0 auto;
}

/* ê³µí†µ ì¹´ë“œ */
.section {
    margin: 25px auto;
    width: 100%;
    max-width: 780px;
    background: white;
    padding: 22px 25px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
}

/* ì…ë ¥ ì˜ì—­ */
.input-wrapper {
    width: 80%;
    margin: 0 auto;
}

input, textarea {
    font-family: 'Galmuri11', sans-serif;
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    border-radius: 7px;
    border: 1px solid #dcd6ce;
    background: #faf7f2;
    font-size: 10px;
}

textarea {
    height: 70px;
    resize: vertical;
}

.sub-explain {
    font-size: 9px;
    color: #7a6f62;
    margin-bottom: 10px;
    opacity: 0.8;
}

/* ë²„íŠ¼ ê¸°ë³¸ */
button {
    width: 100%;
    margin-top: 10px;
    padding: 10px;
    border: none;
    border-radius: 8px;
    background: #7f6a50;
    color: white;
    font-size: 12px;
    cursor: pointer;
}

button:hover {
    background: #614f3a;
}

/* ë©”ì‹œì§€ ë°•ìŠ¤ */
.msg-item {
    padding: 10px 0;
    border-bottom: 1px solid #e6e0d7;
    text-align: left;
    font-size: 11.5px;
    position: relative;
}

/* ë‹‰ë„¤ì„ */
.msg-nick {
    font-weight: bold;
    margin-bottom: 3px;
}

/* ì‚­ì œ ë²„íŠ¼ */
.delete-btn {
    background: white;
    border: 1px solid #ccc;
    color: #555;
    padding: 2px 6px; /* ğŸ”¥ ë” ì‘ì•„ì§„ ì»´íŒ©íŠ¸ ë²„íŠ¼ */
    font-size: 9px;
    border-radius: 4px;
    cursor: pointer;

    /* ë©”ì‹œì§€ ì˜¤ë¥¸ìª½ ë ì •ë ¬ */
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
}

.delete-btn:hover {
    background: #f2f2f2;
}

/* ê´€ë¦¬ì ëª¨ë“œ ë²„íŠ¼ */
.admin-btn {
    margin: 25px auto;
    font-size: 9px;
    color: #6a5f54;
    text-decoration: underline;
    cursor: pointer;
    opacity: 0.8;
}

.admin-btn:hover {
    opacity: 1;
}
</style>
</head>

<body>

<div class="copyright">
    Copyright. 2025. Team Whale All rights reserved.
</div>

<header>
    <div class="top-right-box">
        <div class="music-text">ğŸµToday's BGM - ë¹„í–‰ìš´(Healing ver.)</div>
        <iframe class="music-box"
            src="https://www.youtube.com/embed/tarCvk403H4?autoplay=1&loop=1&playlist=tarCvk403H4"
            frameborder="0"
            allow="autoplay">
        </iframe>
    </div>
</header>

<div class="content-wrapper">

    <div class="hero-image"></div>

    <div class="section">
        <h2 style="margin-top:0;">ì¼ì´Œí‰ ì‘ì„±í•˜ê¸°</h2>
        <div class="sub-explain">
            ë™í™˜êµ°ì˜ ë§ˆì§€ë§‰ì´ í–‰ë³µí•  ìˆ˜ ìˆë„ë¡, ì—¬ëŸ¬ë¶„ì˜ ì¶”ì–µì„ ë‹´ì•„ ì¼ì´Œí‰ì„ ì‘ì„±í•´ì£¼ì„¸ìš” ğŸ™ğŸ»
        </div>

        <div class="input-wrapper">
            <input id="nickname" placeholder="ë‹‰ë„¤ì„">
            <textarea id="comment" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            <button onclick="saveMessage()">ì „ë‹¬í•˜ê¸°</button>
        </div>
    </div>

    <div class="section">
        <h2 style="margin-top:0;">[ì¼ì´Œí‰] ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤ ğŸ’Œ</h2>
        <div id="messageList"></div>
    </div>

    <!-- ê´€ë¦¬ì ëª¨ë“œ ë²„íŠ¼ -->
    <div class="admin-btn" onclick="adminLogin()">ê´€ë¦¬ì ëª¨ë“œ</div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
// Firebase ì„¤ì •
const firebaseConfig = {
  apiKey: "AIzaSyAjMGp5dOAZ5ms8MGYD9C2XziV8YsoWjvU",
  authDomain: "goodbye-dongwhan.firebaseapp.com",
  databaseURL: "https://goodbye-dongwhan-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "goodbye-dongwhan",
  storageBucket: "goodbye-dongwhan.firebasestorage.app",
  messagingSenderId: "322370249896",
  appId: "1:322370249896:web:a5da7e2095208f058f4e9d"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ìœ ì € UID ì €ì¥
if (!localStorage.getItem("guest_uid")) {
    localStorage.setItem("guest_uid", "uid_" + Date.now() + "_" + Math.random().toString(36).substr(2, 9));
}
const myUID = localStorage.getItem("guest_uid");

// ê´€ë¦¬ì ëª¨ë“œ ì—¬ë¶€
let isAdmin = localStorage.getItem("isAdmin") === "true";

// ê´€ë¦¬ì ë¡œê·¸ì¸
function adminLogin() {
    const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
    if (pw === "whaleproject") {
        alert("ê´€ë¦¬ì ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
        isAdmin = true;
        localStorage.setItem("isAdmin", "true");
        renderMessages();
    } else {
        alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
    }
}

// ë©”ì‹œì§€ ì €ì¥
function saveMessage() {
    const nick = document.getElementById("nickname").value.trim();
    const msg  = document.getElementById("comment").value.trim();

    if (!nick || !msg) {
        alert("ë‹‰ë„¤ì„ê³¼ ë©”ì‹œì§€ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        return;
    }

    db.ref("messages").push({
        nickname: nick,
        message: msg,
        uid: myUID,
        time: Date.now()
    });

    document.getElementById("nickname").value = "";
    document.getElementById("comment").value = "";
}

// ë©”ì‹œì§€ ì‚­ì œ
function deleteMessage(key) {
    if (!confirm("ì •ë§ ì‚­ì œí• ê¹Œìš”?")) return;
    db.ref("messages/" + key).remove();
}

// ë©”ì‹œì§€ ë Œë”ë§
function renderMessages() {
    db.ref("messages").once("value", (snapshot) => {
        const list = document.getElementById("messageList");
        list.innerHTML = "";

        snapshot.forEach(child => {
            const v = child.val();
            const isMine = (v.uid === myUID);
            const deletable = isMine || isAdmin;

            list.innerHTML += `
                <div class="msg-item">
                    <div class="msg-nick">${v.nickname}</div>
                    <div>${v.message}</div>
                    ${ deletable ? `<button class="delete-btn" onclick="deleteMessage('${child.key}')">ì‚­ì œ</button>` : "" }
                </div>
            `;
        });
    });
}

// ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
db.ref("messages").on("value", () => renderMessages());

</script>

</body>
</html>
